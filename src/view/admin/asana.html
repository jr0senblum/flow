
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Flow!</title>
    
    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">
    
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <link href="/static/css/chosen.min.css" rel="stylesheet">
    
  </head>
  <body>
    

    <div class="container-fluid">
      <div class="row">
	<div class="col-md-12">
	  <div class="page-header">
	    <h1> Flow <small> ... asina for creativity</small> </h1>
	  </div>
	</div>
      </div>
      <div class="row">
	<div class="col-md-12">
	  <h3 class="text-primary text-left"></h3>

          <div class="col-md-4">
	    <h3 class="text-left text-warning"> Enters From</h3>

            <select id="froms" data-placeholder="Choose" style="width:350px;" 
                    multiple class="chosen-select">
            </select>

	  </div>
	<div class="col-md-4">
	  <h3 id="ename" class="text-center text-success"> </h3>
           <div class="btn-group">
	    <button class="btn btn-default" type="button" onclick="toggleStrength()">
	      <em id="strength" class={% if asana.strength %} "glyphicon glyphicon-ok" {% else %} "glyphicon glyphicon-remove" {% endif %} ></em> Strength
	    </button>
	    <button class="btn btn-default" type="button" onclick="toggleBallance()">
	      <em id="ballance" class={% if asana.ballance %} "glyphicon glyphicon-ok" {% else %} "glyphicon glyphicon-remove" {% endif %} ></em> Ballance
	    </button>
	    <button  class="btn btn-default" type="button" onclick="toggleFlexibility()">
	      <em id="flexibility" class={% if asana.flexibility %} "glyphicon glyphicon-ok" {% else %} "glyphicon glyphicon-remove" {% endif %} ></em> Flexibility
	    </button> 
	  </div>
          
          <div> <img id="pic"  alt="Asana Picture" src={{ path }}></div>
	  <div class="btn-group">
	    <button id="left" class="btn btn-default" type="button" onclick="previous()">
	      <em class="glyphicon glyphicon-chevron-left" ></em> Previous
	    </button>
	    <button id="right" class="btn btn-default" type="button" onclick="next()">
	      <em  class="glyphicon glyphicon-chevron-right" ></em> Next
	    </button>
	    <button id="reset" class="btn btn-default" type="button" onclick="reset()">
	      <em  class="glyphicon glyphicon-refresh" ></em> Reset
	    </button>
	    <button  class="btn btn-default" type="button" onclick="saveCurrent()">
	      <em  id="save" class="glyphicon glyphicon-saved" ></em> Save
	    </button>
            
	  </div>
	</div>

        <div class="col-md-4">
          <div class="col-md-4">
	    <h3 class="text-left text-warning"> Exits To</h3>

            <select id="tos" data-placeholder="Choose" style="width:350px;" 
                    multiple class="chosen-select">
            </select>

	  </div>
        </div>
        </div>
      </div>
    </div>
    <div class="row">
	<div class="col-md-6">
	  <div class="row">

	  </div>
	  <table id="mg" class="table table-condensed table-striped">
	    <thead>
	      <tr>
	        <th>
		  Major Muscle Groups
	        </th>
	      </tr>
	    </thead>
	    <tbody>
	    </tbody>
	  </table>
	</div>
	<div class="col-md-6">
	  <div class="row">

	  </div>
	  <table id="rom" class="table table-condensed table-striped">
	    <thead>
	      <tr>
	        <th>
		  Joints and Ranges
	        </th>
	      </tr>
	    </thead>
	    <tbody>
	    </tbody>
	  </table>
	</div>
      </div>
      <div class="row">
	<div class="col-md-12">
	</div>
      </div>
    </div>


  <script src="/static/js/jquery.min.js"></script>
  <script src="/static/js/bootstrap.min.js"></script>
  <script src="/static/js/scripts.js"></script>
  <script src="/static/js/chosen.jquery.min.js"></script>

  <script>
  $( document ).ready(function() {
    loadAllAsana(0);
    toggleSave(true);
  });

$("#froms").chosen();
$("#tos").chosen();


var asanas = new Array();
var current = 0;

function reset() {
  loadAllAsana(current);
};

function toggleSave(state) {
  if (state == true) {
    $("#save").removeClass("glyphicon-save");
    $("#save").addClass("glyphicon-saved");
    setNextPrevStatus();
  } else {
    $("#save").removeClass("glyphicon-saved");
    $("#save").addClass("glyphicon-save");
    toggleButtonStatus($('#left'), true);
    toggleButtonStatus($('#right'), true);
  }};

function saveCurrent() {
  $.post("/admin/asana/update",
         {new_asana:JSON.stringify(asanas[current])},
         function(data,status) { });
  toggleSave(true);
};


function next() {
  if (current < asanas.length - 1) {
    current = current + 1;
    displayAsana();
    getDetails();
  };
  setNextPrevStatus();
};

function previous() {
  if (current > 0) {
    current = current - 1;
    displayAsana();
    getDetails();
  };
  setNextPrevStatus();
};


function toggleButtonStatus(a_button, state) {
  a_button.prop("disabled", state);
};

function setNextPrevStatus() {
  toggleButtonStatus($('#right'), (current == asanas.length - 1));
  toggleButtonStatus($('#left'), (current == 0));
};


function loadAllAsana(NewCurrent) {
  $.ajax("/admin/asana/all",
         { cache: false,
           success: function(data, code, xhr) {
             asanas = data.asanas;
             current = NewCurrent;
             toggleSave(true);
             displayAsana();
             getDetails();
           }})};


function getDetails() {
  $.ajax("/admin/details/" + asanas[current].id,
         { cache: false,
           success: function(data, code, xhr) {
             loadMgs(data.mg);
             loadRanges(data.rom);
             loadEnters(data.enters);
             loadExits(data.exits)}
         })
};

function loadMgs(groups) {
  var Rows = "";
  $('#mg tbody').empty()
  for (i = 0; i < groups.length; i++) {
    Rows = Rows + 
      "<tr class='success'>" +
      "<td>" + groups[i].name + "</td></tr>";
  };
  $('#mg > tbody:last-child').append(Rows);
};


function loadRanges(ranges) {
  var Rows = "";
  $('#rom tbody').empty()
  for (i = 0; i < ranges.length; i++) {
    Rows = Rows + 
      "<tr class='success'>" +
      "<td>" + ranges[i].name + "</td></tr>";
  };
  $('#rom > tbody:last-child').append(Rows);
};


function loadEnters(enters) {
  var Rows = "";
  var Found = new Array();
  
  for (i = 0; i < enters.length; i++) {
    Rows = Rows + 
      '<option value="' + enters[i].id + '" selected>' + 
      enters[i].name + '</option>';
    Found.push(enters[i].id);
  };
  $('#froms').html(Rows);

  Rows = "";
  for (i = 0; i < asanas.length; i++) {
    if (Found.indexOf(asanas[i].id) == -1 && i != current) {
      Rows = Rows + 
        '<option value="' + asanas[i].id + '">' + 
        asanas[i].name + '</option>';
    };
  };
  $('#froms').append(Rows);
  $("#froms").trigger("chosen:updated")
};


function loadExits(exits) {
  var Rows = "";
  var Found = new Array();
  
  for (i = 0; i < exits.length; i++) {
    Rows = Rows + 
      '<option value="' + exits[i].id + '" selected>' + 
      exits[i].name + '</option>';
    Found.push(exits[i].id);
  };
  $('#tos').html(Rows);

  Rows = "";
  for (i = 0; i < asanas.length; i++) {
    if (Found.indexOf(asanas[i].id) == -1 && i != current) {
      Rows = Rows + 
        '<option value="' + asanas[i].id + '">' + 
        asanas[i].name + '</option>';
    };
  };
  $('#tos').append(Rows);
  $("#tos").trigger("chosen:updated")
};



function displayAsana() {
  $("#ename").text(asanas[current].name + " - " + asanas[current].sanskrit);

  if (asanas[current].strength) {
    $("#strength").removeClass("glyphicon-remove");
    $("#strength").addClass("glyphicon-ok")
  } else {
    $("#strength").removeClass("glyphicon-ok");
    $("#strength").addClass("glyphicon-remove");
  };

  if (asanas[current].ballance) {
    $("#ballance").removeClass("glyphicon-remove");
    $("#ballance").addClass("glyphicon-ok")
  } else {
    $("#ballance").removeClass("glyphicon-ok");
    $("#ballance").addClass("glyphicon-remove");
  };

  if (asanas[current].flexibility) {
    $("#flexibility").removeClass("glyphicon-remove");
    $("#flexibility").addClass("glyphicon-ok")
  } else {
    $("#flexibility").removeClass("glyphicon-ok");
    $("#flexibility").addClass("glyphicon-remove");
  };

  $("#pic").attr('src', "/static/stickfigures/" + asanas[current].name.toLowerCase() + ".jpg");

};

function toggleStrength() {
  asanas[current].strength = ! asanas[current].strength ;
  displayAsana();
  toggleSave(false);
};

function toggleFlexibility() {
  asanas[current].flexibility = ! asanas[current].flexibility ;
  displayAsana();
  toggleSave(false);
};

function toggleBallance() {
  asanas[current].ballance = ! asanas[current].ballance ;
  displayAsana();
  toggleSave(false);
}
  





</script>



  </body>



</html>


